


注意事项：
Sfkfssz 里面存的金额，与押金操作看到的相同，收入为正，找回为负值（注意）

2012-03-01  华都会议问题的总结
主要有两个问题：
1.连房以及连帐的区别
2.参观房的设置
3.结帐后的平帐付款方式的调整
4.新系统中，要更改一下（消费项目的选择）---自动填写消费类别--(以经修改完成）


2012-03-02  遇到的问题！！！！！！！！


2012-03-02  更新，消费名细的选择（选择消费项目的时候，可以直接找到所有的项目，并自动填写消费类别）---以经更改
2012-03-02  更改  消费名细里面的CZZT，要根据主单的状态（例如主单是预订的时候传预订，是记/挂的时候冲补帐,（更改一下这个字段的值)

Jzzd  Jzmx   Jzzd_bak  Jzmx_bak  加xyh
(更新services端的)


2.27-2.28  完成挂/记  转结帐

挂/记  转结---主要是:

A  更改jzzd  jzmx的操作状态，然后分别备份到对应的BAK

B  删除Szwmx里面的记录，Syjcz

C  注意要先平帐

3.5 工作内容：
注意事项：
1. 分结操作使用的临时表和Szw_temp的用法类似
（只出现消费的项目,时间上要从早到晚，以保证最先消费的帐务先结掉）

2. 取消的时候，注意，要加到原来的帐务上面去(jzbh_new)

3. 单拆的功能
（消费摘要:拆帐)


4. 分结的流程：（按金额分结，按比例分结）
  A  找到要拆帐的那条记录，进行拆帐 
  B  拆帐时:Szwmx,Ssyxfmx,Ssyxfmx_cz,Szw_union,Szw_zz_fj_temp
  C  撤消回去的时候(全消与单销)
  D  单销的操作（考虑此条记录是否在Szw_union里面出现）
 

5. 拆帐的时候，jjje保持不变,分拆xfsl这个值（xfje与sjxfje先保持一致）


6. 验证一下,转帐操作

7. 拆帐撤消更新(第一条被拆完并且显示在以经选择的记录里面时与被拆后没有被选择在以经选择的记录里面的不同）
    A.判断union里面对应的记录，是否有在Szw_zz_fj_temp里面
      如果在的，就直接将当前的记录从Szw_zz_fj_temp中删除
      如果没有，删除的同时，还要把数值加回去 
  
    全部撤消的处理(再验证一下）
   
8. Szwzd在消费和交押金的同时要修改相应的fkje,xfje;   


9.记、挂分结的步骤：
    部分结帐：
    A.生成新的结帐编号（写入Sjzzd, Sjzmx,(要被结掉的记录的id_app存储在Szw_zz_fj_temp这张表里面))
    B.将Szwmx里面id_app在Szw_zz_FJ_temp这种记录写入到Szw_temp中（注意操作员）
    (以上客户端完成)
    
    C.调用结帐操作的webservices
       （部分结与结帐的不同是:不能退房，只删除结掉的记录而己)
        (1)部分结
        (2)记/挂--分结
            备份Szw_temp中出现的id_app这样的记录（备份sjzzd,备份zwmx,备份syxfmx)
            （Sjzzd  根据结掉的金额减掉一部分，生成一条新的Sjzzd）
            （Szwmx里面id_app在Szw_temp里面的,要删除掉，更新syxfmx里面id_app在Szw_temp中的记录）
           拆帐时，对于记挂帐的拆帐还要注意的是：由于记挂的帐在Szwmx和Sjzmx里面都存在的，拆帐的时候，要保持这两个地方的帐务一致
            
       
      
    D.更新  服务端有关bfsz的部分 
       （结掉的部分金额还要从Szwzd中修改相应的记录）


   记挂帐的分结： 
   A. 生成新的结帐编号（先备份之前的记录到Sjzzd_bak，修改当前Sjzzd对应的xfje(结掉的部分要减掉),
   B. Sjzmx里面
   
   
   
   10  对所有协议单位的处理，只能通过主单记录里面读取，如果首次没有录入的话，其实的地方录入的
   有后续的计算中，全部都按空处理
   
   
   
   
   
   ------------------------------------------------------------
   报表：(2012-05-02    打印单据记录)
   1.为A4
   2.为A5
   3.为带表头A4
   4.为带表头A5
   
   
   
   
   
   
   
------------------------------------------------------------
  
2012-05-02  PM更新内容

1.Common_zw          Get_xf_info()  的修改
2.Sxfxm.cs               btn_xfmx_select_Click(object sender, EventArgs e)  
3. public string mxbh = "";//新增


4.冲补账的更新     SczOrbz.cs


5.





 
